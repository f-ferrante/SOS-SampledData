\documentclass[a4paper,12pt,english]{amsart}


%DIN A4
\usepackage[paperwidth=210mm,paperheight=297mm,inner=3cm,outer=3cm,top=2.5cm,bottom=2.6cm]{geometry}

\linespread{1.05}

\usepackage{mathrsfs}
%\renewcommand\bfdefault{b}
%\renewcommand\ttdefault{txtt}
%\usepackage[LY1]{fontenc}
%\newcommand\mathscr[1]{\mathcal{#1}}
%\renewcommand\scshape{\bfseries}

\usepackage[utf8x]{inputenc} 
%\usepackage[applemac]{inputenc}

\usepackage[normalem]{ulem}

\newcommand\new[1]{{\color{blue}{#1}}}
\newcommand\old[1]{{\color{red}\sout{#1}}}

\usepackage[leqno]{amsmath}
\usepackage[pdftex]{graphicx}    
\usepackage{amsthm,amssymb}
\usepackage{amsrefs}
\usepackage{mathtools}
\usepackage{babel}
\usepackage{caption}
\usepackage{etex}
\usepackage{fancyvrb}
\usepackage[colorlinks,linkcolor=black,citecolor=black,urlcolor=black,hypertexnames=true]{hyperref}
\urlstyle{rm}
%\usepackage[retainorgcmds]{IEEEtrantools}
\usepackage{paralist}
\usepackage{tikz}
%\usepackage{xypic}

\newcommand\mymid{\,\, : \,\,}
\newcommand\ccheck{{\bf (CHECK)}}

%% MACROS Francesco
\newcommand{\Spn}{\mathcal{S}^n_{+}}
%% MACROS
\newcommand\nvar{n}
\newcommand\npol{m}
\newcommand\mmod{{\mcal M}}
\newcommand\A{{\mcal A}}
\newcommand\lvec{r}
\newcommand\K{K}
\newcommand\rel{\mathrm{Rel}}

\newcommand\mbb{\mathbb}
\newcommand\mbf{\mathbf}
\newcommand\mcal{\mathscr}
\newcommand\mfr{\mathfrak}
\newcommand\ol{\overline}
\newcommand\ul{\underline}
\newcommand\wh{\widehat}
\newcommand\wt{\widetilde}

\newcommand\sA{\mcal{A}}
\newcommand\sB{\mcal{B}}
\newcommand\sC{\mcal{C}}
\newcommand\sD{\mcal{D}}
\newcommand\sE{\mcal{E}}
\newcommand\sF{\mcal{F}}
\newcommand\sG{\mcal{G}}
\newcommand\sH{\mcal{H}}
\newcommand\sI{\mcal{I}}
\newcommand\sJ{\mcal{J}}
\newcommand\sK{\mcal{K}}
\newcommand\sL{\mcal{L}}
\newcommand\sM{\mcal{M}}
\newcommand\sN{\mcal{N}}
\newcommand\sO{\mcal{O}}
\newcommand\sP{\mcal{P}}
\newcommand\sQ{\mcal{Q}}
\newcommand\sR{\mcal{R}}
\newcommand\sS{\mcal{S}}
\newcommand\sT{\mcal{T}}
\newcommand\sU{\mcal{U}}
\newcommand\sV{\mcal{V}}
\newcommand\sW{\mcal{W}}
\newcommand\sX{\mcal{X}}
\newcommand\sY{\mcal{Y}}
\newcommand\sZ{\mcal{Z}}

\newcommand\fA{\mathfrak{A}}
\newcommand\fB{\mathfrak{B}}
\newcommand\fC{\mathfrak{C}}
\newcommand\fD{\mathfrak{D}}
\newcommand\fE{\mathfrak{E}}
\newcommand\fF{\mathfrak{F}}
\newcommand\fG{\mathfrak{G}}
\newcommand\fH{\mathfrak{H}}
\newcommand\fI{\mathfrak{I}}
\newcommand\fJ{\mathfrak{J}}
\newcommand\fK{\mathfrak{K}}
\newcommand\fL{\mathfrak{L}}
\newcommand\fM{\mathfrak{M}}
\newcommand\fN{\mathfrak{N}}
\newcommand\fO{\mathfrak{O}}
\newcommand\fP{\mathfrak{P}}
\newcommand\fQ{\mathfrak{Q}}
\newcommand\fR{\mathfrak{R}}
\newcommand\fS{\mathfrak{S}}
\newcommand\fT{\mathfrak{T}}
\newcommand\fU{\mathfrak{U}}
\newcommand\fV{\mathfrak{V}}
\newcommand\fW{\mathfrak{W}}
\newcommand\fX{\mathfrak{X}}
\newcommand\fY{\mathfrak{Y}}
\newcommand\fZ{\mathfrak{Z}}
\newcommand\fa{\mathfrak{a}}
\newcommand\fb{\mathfrak{b}}
\newcommand\fc{\mathfrak{c}}
\newcommand\fm{\mathfrak{m}}
\newcommand\fn{\mathfrak{n}}
\newcommand\fo{\mathfrak{o}}
\newcommand\fp{\mathfrak{p}}
\newcommand\fq{\mathfrak{q}}
\newcommand\fr{\mathfrak{r}}

\newcommand\PP{\mbb{P}}
\newcommand\CC{\mbb{C}}
\newcommand\FF{\mbb{F}}
\newcommand\NN{\mbb{N}}
\newcommand\QQ{\mbb{Q}}
\newcommand\RR{\mbb{R}}
\newcommand\ZZ{\mbb{Z}}
\newcommand\bbS{\mbb{S}}

\DeclareMathOperator\clos{clos}
\DeclareMathOperator\tint{int}
\newcommand\V{\mathcal{V}}
\DeclareMathOperator\gr{Gr}

\newcommand\sym{\mathcal{S}}
\newcommand\scp[1]{\langle #1 \rangle}

\numberwithin{equation}{section}
\newcommand\nosubsection{\setcounter{equation}{0}}

\theoremstyle{remark}
\newtheorem{Paragraph}[equation]{}

\renewcommand\bibname{References}

\theoremstyle{plain}
\newtheorem{Thm}[equation]{Theorem}
\newtheorem{thm}[equation]{Theorem}
\newtheorem{Prop}[equation]{Proposition}
\newtheorem{prop}[equation]{Proposition}
\newtheorem{Cor}[equation]{Corollary}
\newtheorem{cor}[equation]{Corollary}
\newtheorem{Lemma}[equation]{Lemma}
\newtheorem{lem}[equation]{Lemma}
\newtheorem{Conjecture}[equation]{Conjecture}
\newtheorem{conj}[equation]{Conjecture}

\newtheorem*{Thm*}{Theorem}
\newtheorem*{Prop*}{Proposition}
\newtheorem*{Cor*}{Corollary}
\newtheorem*{Lemma*}{Lemma}
\newtheorem*{Sublemma*}{Sublemma}
\newtheorem*{Conjecture*}{Conjecture}

\theoremstyle{definition}
\newtheorem{problem}{Problem}
\newtheorem{Def}[equation]{Definition}
\newtheorem{Defs}[equation]{Definitions}
\newtheorem{defi}[equation]{Definition}
\newtheorem{Example}[equation]{Example}
\newtheorem{Examples}[equation]{Examples}
\newtheorem{LemmaDef}[equation]{Lemma and Definition}
\newtheorem{Notation}[equation]{Notation}
\newtheorem{Problem}[equation]{Problem}
\newtheorem{Question}[equation]{Question}
\newtheorem{Remark}[equation]{Remark}
\newtheorem{rem}[equation]{Remark}
\newtheorem{Remarks}[equation]{Remarks}
\newtheorem{Warning}[equation]{Warning}

\newtheorem*{Def*}{Definition}
\newtheorem*{Defs*}{Definitions}
\newtheorem*{Example*}{Example}
\newtheorem*{Examples*}{Examples}
\newtheorem*{LemmaDef*}{Lemma and Definition}
\newtheorem*{Notation*}{Notation}
\newtheorem*{Problem*}{Problem}
\newtheorem*{Question*}{Question}
\newtheorem*{Remark*}{Remark}
\newtheorem*{Remarks*}{Remarks}
\newtheorem*{Warning*}{Warning}


\title{Notes}

\begin{document}
\maketitle

\setcounter{section}{1}

\subsection{Problem Statement}
The problem we want to solve is as follows
\begin{problem}
Let $A\in\RR^{n\times n}, B\in\RR^{n\times m}, C\in\RR^{m\times n}, D\in\RR^{m\times m}$, and $T\in\RR_{>0}$ be given. Determine $P$ and $Q$ symmetric positive definite matrices and a polynomial $p\colon[0,T]\rightarrow\RR_{>0}$ such that
$$
\langle\nabla V(x),f(x)\rangle<0\qquad \forall x\in\RR^{n+m}\times[0,T]
$$
where $x\coloneqq (x_p,\tau)=(x_1, x_2, \tau)$ and for all $x\in\RR^{n+m}\times[0,T]$
$$
\begin{aligned}
&V(x)\coloneqq x_1^\top P x_1+p(\tau)x_2^\top Q x_2\\
&f(x)\coloneqq 
\begin{pmatrix} 
Ax_1+B x_2\\
Cx_1+D x_2\\
-1
\end{pmatrix}
\end{aligned}
$$
\new{
Alternatively
$$
\begin{aligned}
&V(x)\coloneqq x_1^\top P x_1+x_2^\top Q(\tau) x_2\\
\end{aligned}
$$
where $Q(\tau)$ is a polynomial matrix with entries of degree
at most $d$.}
\end{problem}



\subsection{Positive polynomials over intervals.}
This is a direct application of classical Positivstellensatz for positive polynomials
over intervals. We include a proof for the sake of self-containedness.
\begin{lem}
  Let $T>0$, and let $p \in \RR[\tau]$ be of degree $d$ and nonnegative on
  $[0,T]$. Then there exists sums of squares $\sigma_0,\sigma_1 \in \RR[\tau]$, of
  degree $\deg(\sigma_0) \leq 2d$ and $\deg(\sigma_1) \leq 2d-2$ such that
  $$
  %  p(\tau) = \sigma_0(\tau)+\left(1-\left(\frac{2\tau-T}{T}\right)^2\right)\sigma_1(\tau)
  p(\tau) = \sigma_0(\tau)+\new{\left( \tau T - \tau^2 \right)}\sigma_1(\tau)
  $$
  for all $\tau \in \RR$.
\end{lem}
\begin{proof}
  We define the linear transformation $\varphi(\tau)=\frac{T\tau+T}{2}$ and its inverse
  $\varphi^{-1}(t)=\frac{2t-T}{T}$. Remark that $\varphi$ and $\varphi^{-1}$ send $[-1,1]$
  and $[0,T]$ to each other, and deduce that the polynomial
  $$
  f(t)=p(\varphi(t)) = p\left(\frac{Tt+T}{2}\right)
  $$
  is nonnegative for all $t \in [-1,1]$. By \cite[Th.2.4(a)]{lasserre}, there exists
  sums of squares $\overline{\sigma_0},\overline{\sigma_1} \in \RR[t]$ of degree
  $\deg(\overline{\sigma_0}) \leq 2d$ and $\deg(\overline{\sigma_1}) \leq 2d-2$ such that
  $$
  f = \overline{\sigma_0}+(1-t^2)\overline{\sigma_1}
  $$
  for all $t \in \RR$. Hence one can apply the inverse transformation
  $t=\varphi^{-1}(\tau)$ to get
  $$
  p(\tau) = f(\varphi^{-1}(\tau)) = \overline{\sigma_0}(\varphi^{-1}(\tau))+(1-(\varphi^{-1}(\tau))^2)\overline{\sigma_1}(\varphi^{-1}(\tau))
  $$
  and we conclude by observing that $\sigma_i:=\new{\frac{4}{T^2}}\overline{\sigma_i}(\varphi^{-1}(\tau))$
  are sums of squares in $\RR[\tau]$, with degree  bounded by that of
  the $\overline{\sigma_i}$.
\end{proof}

Hence one can express positivity of $p$ via a semidefinite program with two blocks, \new{exactly as follows:
$$
\begin{aligned}
  & p(\tau) = v_d(\tau)^T X_0 v_d(\tau) + \left( \tau T - \tau^2 \right)
  v_{d-1}(\tau)^T X_1 v_{d-1}(\tau) \\
&
\begin{pmatrix} 
X_0 & \\
& X_1
\end{pmatrix}
\succeq 0.
\end{aligned}
$$
where $v_i(\tau)$ is the column vector with entries $1,\tau,\tau^2,\ldots,\tau^i$. The first line is a linear system in the $\binom{d+1}{2}+\binom{d}{2}$ variables of $X_0$ and $X_1$, and with $d+1$ constraints. Hence the LMI to be solved will have
$$
\text{size } = d+d-1 = 2d-1
$$
$$
\text{number of variables } = \binom{d+1}{2}+\binom{d}{2}-(d+1) = d^2-d-1.
$$
}

\new{
\subsection{Positive matrix polynomials over intervals.}

We consider the second model for the Lyapunov function $V$, that is
$$
V(x)\coloneqq x_1^\top P x_1+x_2^\top Q(\tau) x_2.
$$
Since $P$ has to be positive definite, we impose that $Q(\tau)$ is positive semidefinite for $\tau \in [0,T]$,
which gives a sufficient condition for $V(x)>0$.

We recall that $Q(\tau) = \sum_{i=0}^d Q_i \tau^i$ has degree at most $d$ as polynomial matrix. The following Lemma
gives a certificate of positivity over $[0,T]$.
\begin{lem}\label{matrixhandelman}
  Let $Q=Q(\tau)$ be a symmetric polynomial matrix of degree at most $d$ and positive definite over $[0,T]$.
  Then UNDER ASSUMPTIONS TO BE CHECKED there exist an integer $N$ and positive definite symmetric matrices
  $X_\alpha$, for $\alpha=(\alpha_1,\alpha_2)$ with $\alpha_1+\alpha_2=N+d$ such that
  $$
  Q = \sum_\alpha X_\alpha \tau^{\alpha_1}(T-\tau)^{\alpha_2}
  $$
\end{lem}
\begin{proof}
  Remark that $[0,T]$ is convex, compact and defined by the linear inequalities $\tau \geq 0, T-\tau \geq 0$.
  Then the thesis follows from the Matrix Handelman's Positivstellensatz \cite[Th.3]{handelman}. 
\end{proof}
The same theorem \cite[Th.3]{handelman} gives upper bounds for $N$ that are quadratic on $d$.
We deduce from Lemma \ref{matrixhandelman} that the condition $Q(\tau) \succeq 0$ can be tested by solving
the linear matrix inequality
$$
\begin{aligned}
  & Q(\tau) = \sum_{\alpha_1+\alpha_2=N+d} X_\alpha \tau^{\alpha_1}(T-\tau)^{\alpha_2} \\
  &
  \bigoplus_{\alpha_1+\alpha_2=N+d} X_\alpha \succeq 0.
\end{aligned}
$$
If $Q$ is $m \times m$, then the previous LMI has
$$
\text{size } = m(N+d+1)
$$
$$
\text{number of variables } = (N+d+1)\binom{m+1}{2}-\binom{m+1}{2} = (N+d)\binom{m+1}{2}.
$$
}





\newpage
\begin{thebibliography}{9}

\bibitem{lasserre}
Lasserre, J-B. An introduction to polynomial and semi-algebraic optimization. Vol. 52. Cambridge University Press, 2015.

\new{
\bibitem{handelman}
Lê, C-T. and Du, T-H-B.
Handelman’s Positivstellensatz for polynomial matrices positive definite on polyhedra. Positivity 22.2 (2018): 449-460.}

\end{thebibliography}


\end{document}
